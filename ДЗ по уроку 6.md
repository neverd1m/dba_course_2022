    создайте виртуальную машину c Ubuntu 20.04 LTS (bionic) в GCE типа e2-medium в default VPC в любом      регионе и зоне, например us-central1-a
    

> Выполнено.

    поставьте на нее PostgreSQL 14 через sudo apt
  

>    Выполнено.

    проверьте что кластер запущен через sudo -u postgres pg_lsclusters

> Выполнено.

    зайдите из под пользователя postgres в psql и сделайте произвольную таблицу с произвольным содержимым postgres=# create table test(c1 text); postgres=# insert into test values('1'); \q
    

> Выполнено.

    остановите postgres например через sudo -u postgres pg_ctlcluster 14 main stop
    

> Выполнено.

    создайте новый standard persistent диск GKE через Compute Engine -> Disks в том же регионе и зоне что GCE инстанс размером например 10GB
   

>  Выполнено.

    добавьте свеже-созданный диск к виртуальной машине - надо зайти в режим ее редактирования и дальше выбрать пункт attach existing disk
   

> Выполнено.

    проинициализируйте диск согласно инструкции и подмонтировать файловую систему, только не забывайте менять имя диска на актуальное, в вашем случае это скорее всего будет /dev/sdb - https://www.digitalocean.com/community/tutorials/how-to-partition-and-format-storage-devices-in-linux

> Выполнено.

    перезагрузите инстанс и убедитесь, что диск остается примонтированным (если не так смотрим в сторону fstab)


> отредактировал fstab

    сделайте пользователя postgres владельцем /mnt/data - chown -R postgres:postgres /mnt/data/


> Выполнено.

    перенесите содержимое /var/lib/postgres/14 в /mnt/data - mv /var/lib/postgresql/14 /mnt/data


> Выполнено.

    попытайтесь запустить кластер - sudo -u postgres pg_ctlcluster 14 main start


> Выполнено.

    напишите получилось или нет и почему
    

> Кластер не запустился, выдал ошибку что не найдена директория **/var/lib/postgresql/14/main**.
> Это директория по умолчанию, где расположены данные созданного при установке кластера.

    задание: найти конфигурационный параметр в файлах раположенных в /etc/postgresql/10/main который надо поменять и поменяйте его
    

> Выполнено.

    напишите что и почему поменяли
    

> Заменил в файле **postgresql.conf** параметр data_directory на **/mnt/data/main**. Был **/var/lib/postgresql/14/main**.

    попытайтесь запустить кластер - sudo -u postgres pg_ctlcluster 14 main start
> Выполнено.

    

    напишите получилось или нет и почему
    

> Теперь кластер запустился, так как мы указали существующую директорию.

    
    зайдите через через psql и проверьте содержимое ранее созданной таблицы


> Все на месте, `\dt` показывает наличие таблицы test.

    задание со звездочкой *: не удаляя существующий GCE инстанс сделайте новый, поставьте на его PostgreSQL, удалите файлы с данными из /var/lib/postgres, перемонтируйте внешний диск который сделали ранее от первой виртуальной машины ко второй и запустите PostgreSQL на второй машине так чтобы он работал с данными на внешнем диске, расскажите как вы это сделали и что в итоге получилось.

>  - остановил сервис `postgresql sudo systemctl stop postgresql@14-main` и отмонтировал диск с помощью `umount /mnt/data`. 
   >  - Затем подключил и примонтировал его командой `mount /dev/sdb1 /mnt/data` на втором инстансе и просто запустил **второй** кластер  командой `pg_createcluster 14 main2 -d /mnt/data/main.` 
   > - Причем, кластер не создавался, так как конфигурационные файлы postgresql.conf и др. не были найдены в /mnt/data/main. Для этого я скопировал их из каталога /etc/postgresql/14/main/.
   > - После входа `sudo -u postgres psql -p 5433` и команды `\dt` я также увидел существующую таблицу test. Все супер!

